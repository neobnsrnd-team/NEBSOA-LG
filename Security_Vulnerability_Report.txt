
● Security Vulnerability Report for lib/ JAR Files

  This project contains many critically outdated libraries from 2006-2007 with known security vulnerabilities:

  CRITICAL - Remote Code Execution (RCE)

  | Library             | Version | CVE             | Severity | Description                               |
  |---------------------|---------|-----------------|----------|-------------------------------------------|
  | log4j               | 1.2.13  | CVE-2019-17571  | Critical | Deserialization RCE via SocketServer      |
  | log4j               | 1.2.13  | CVE-2021-4104   | High     | JNDI injection (if JMSAppender used)      |
  | commons-collections | 3.1     | CVE-2015-7501   | Critical | Deserialization RCE - widely exploited    |
  | xstream             | 1.1.3   | CVE-2021-39144+ | Critical | 14+ CVEs, deserialization RCE             |
  | activemq-core       | 4.1.1   | Multiple        | Critical | End of life, multiple RCE vulnerabilities |
  | struts              | Unknown | CVE-2017-5638+  | Critical | Famous Equifax breach vulnerability       |
  | bsh (BeanShell)     | 2.0b4   | CVE-2016-2510   | Critical | Remote code execution                     |

  HIGH - Other Vulnerabilities

  | Library            | Version | Issue                           |
  |--------------------|---------|---------------------------------|
  | dom4j              | 1.6.1   | XXE injection vulnerabilities   |
  | commons-fileupload | 1.0     | Multiple DoS and path traversal |
  | commons-beanutils  | Unknown | Deserialization gadget chain    |
  | itext              | 2.0.4   | Multiple security issues        |
  | lucene-core        | 2.1.0   | XML external entity (XXE)       |
  | jasperreports      | 1.3.4   | Multiple vulnerabilities        |
  | hessian            | 3.0.20  | Deserialization vulnerabilities |
  | commons-dbcp       | 1.2.2   | SQL injection risks             |

  Recommended Upgrades

  log4j-1.2.13.jar         → log4j2 (2.24.x) or logback
  commons-collections-3.1  → commons-collections4 (4.4+)
  xstream-1.1.3.jar        → xstream (1.4.20+) with whitelist
  activemq-core-4.1.1      → activemq (5.18.x+)
  struts.jar               → Remove or upgrade to Struts 6.x
  dom4j-1.6.1.jar          → dom4j (2.1.4+)
  commons-fileupload-1.0   → commons-fileupload2 (2.0+)
  commons-dbcp-1.2.2       → commons-dbcp2 (2.12+)

  Summary

  | Severity   | Count |
  |------------|-------|
  | Critical   | 7+    |
  | High       | 8+    |
  | Medium/Low | Many  |

  Recommendation: This codebase uses libraries that are 15-18 years old. Many have critical RCE vulnerabilities that are actively exploited. A full dependency upgrade is strongly recommended before deploying to production.

  Sources

  - https://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-37215/Apache-Log4j.html
  - https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance
  - https://x-stream.github.io/security.html
  - https://access.redhat.com/security/vulnerabilities/986a8488-052e-46d1-8ede-c55cbfceb822
  - https://www.kb.cert.org/vuls/id/576313




● Security Audit Report

  CRITICAL ISSUES

  1. Weak Cryptography (DES) - HIGH RISK

  Files affected:
  - src/nebsoa/common/util/Encrypter.java:124,143,165,208

  Cipher.getInstance("DES/ECB/PKCS5Padding")
  Issue: DES is obsolete and easily crackable. ECB mode is insecure.
  Recommendation: Use AES-256-GCM instead.

  ---
  2. Weak Hashing (MD5) - HIGH RISK

  File: src/nebsoa/common/util/StringUtil.java:1207

  ret = digest("MD5", inputValue.getBytes());
  Issue: MD5 is cryptographically broken.
  Recommendation: Use SHA-256 or SHA-3.

  ---
  3. XXE Vulnerability - HIGH RISK

  Files affected:
  - src/nebsoa/common/cache/XmlCacheManager.java:328-330
  - src/nebsoa/common/sql/XmlQueryLoader.java:378-380
  - src/nebsoa/common/property/XmlPropertyLoader.java:189-190
  - src/nebsoa/spiderlink/engine/parser/XMLMessageParseHandler.java:136-137

  SAXParserFactory factory = SAXParserFactory.newInstance();
  SAXParser parser = factory.newSAXParser();  // No XXE protection!
  Issue: XML parsers not configured to prevent XXE attacks.
  Recommendation: Add:
  factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);

  ---
  4. Insecure Deserialization - HIGH RISK

  Files affected:
  - src/nebsoa/management/socket/IOHandler.java:91,141
  - src/nebsoa/common/util/StringUtil.java:2579-2580

  ois = new ObjectInputStream(sock.getInputStream());
  mctx = (ManagementContext) ois.readObject();
  Issue: Deserializing untrusted data can lead to RCE.
  Recommendation: Use JSON/XML instead, or implement ObjectInputFilter.

  ---
  MEDIUM ISSUES

  5. Hardcoded Credentials - MEDIUM RISK

  File: src/test/jdbc/JDBCTest.java:15

  String passwd = "ibsdb0308";
  Issue: Test file contains hardcoded password.
  Recommendation: Use environment variables or secure vault.

  ---
  6. Insecure Random - MEDIUM RISK

  Files affected:
  - src/test/uuid/SimpleUUIDGen.java:74,97
  - src/test/uuid/FastUUIDGen.java:96
  - src/test/monitor/MessageDemo.java

  new Random() // Not cryptographically secure
  Issue: java.util.Random is predictable.
  Recommendation: Use SecureRandom for security-sensitive operations.

  ---
  7. Potential Path Traversal - MEDIUM RISK

  Files affected:
  - src/nebsoa/logserver/index/FileIndexBuilder.java:187
  - src/test/schedule/IBSLogBatchFile.java:100

  File dir = new File(defaultDir + dayOfWeek);
  Issue: User input may not be sanitized.
  Recommendation: Validate and canonicalize paths.

  ---
  LOW ISSUES

  8. Password Logging (Commented) - LOW RISK

  Files affected:
  - src/nebsoa/common/error/handler/EmailErrorHandler.java:262
  - src/nebsoa/common/error/handler/MsnErrorHandler.java:237,248

  //System.out.println("password=>"+password);
  Issue: Commented code could be accidentally uncommented.
  Recommendation: Remove these lines entirely.

  ---
  9. Reflection Usage - LOW RISK

  53 files use reflection (Class.forName, newInstance, invoke)
  Issue: Reflection can bypass security if input is not validated.
  Recommendation: Validate class names against whitelist.

  ---
  NO ISSUES FOUND

  - Command Injection: No Runtime.exec() or ProcessBuilder found
  - XSS: No direct response writing detected
  - LDAP Injection: No LDAP operations found
  - SSL/TLS Misconfiguration: No custom TrustManager found

  ---
  Summary

  | Severity | Count | Issues                                           |
  |----------|-------|--------------------------------------------------|
  | CRITICAL | 4     | DES crypto, MD5 hash, XXE, Deserialization       |
  | MEDIUM   | 3     | Hardcoded creds, Insecure random, Path traversal |
  | LOW      | 2     | Password logging, Reflection                     |

  Priority fixes:
  1. Replace DES → AES-256-GCM in Encrypter.java
  2. Add XXE protection to all XML parsers
  3. Replace ObjectInputStream with safe alternatives
  4. Replace MD5 with SHA-256


