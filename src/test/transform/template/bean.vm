## 주어진 프로퍼티의 set 메소드를 만듭니다.
#macro(mutator $propertyName)
#set($method1 = ${propertyName.substring(0, 1).toUpperCase()})
#set($method2 = ${propertyName.substring(1)})
set${method1}${method2}#end

## 주어진 프로퍼티의 get 메소드를 만듭니다.
#macro(accessor $propertyName)
#set($method1 = ${propertyName.substring(0, 1).toUpperCase()})
#set($method2 = ${propertyName.substring(1)})
get${method1}${method2}#end

## 타입별 패딩 캐릭터를 설정합니다.
#macro(distinguishType $fieldType)
#if($fieldType == "String" || $fieldType == "date")HeaderConstants.SPACE_CHAR#else
HeaderConstants.ZERO_CHAR#end
#end

## 프로퍼티에 세팅할 데이터를 타입별로 변환합니다.
#macro(selectVoType $fieldType $count)
#if($fieldType == "String" || $fieldType == "date")temp#elseif($fieldType == "byte" || $fieldType == "short" || $fieldType == "int" || $fieldType == "long" || $fieldType == "length")
(temp.trim().length() != 0) ? Long.parseLong(temp) : this.field${count}#elseif($fieldType == "float" || $fieldType == "double")
(temp.trim().length() != 0) ? Double.parseDouble(temp) : this.field${count}#end
#end

## AllianceVO 에 세팅할 헤더데이터를 타입별로 변환합니다.
#macro(selectVoHeader $fieldType $count)
#if($fieldType == "String" || $fieldType == "date")this.field${count}#elseif($fieldType == "byte" || $fieldType == "short" || $fieldType == "int" || $fieldType == "long" || $fieldType == "length")
Long.toString(this.field${count})#elseif($fieldType == "float" || $fieldType == "double")
Double.toString(this.field${count})#end
#end


## default 값을 설정합니다.
#macro(selectDefaultValue $fieldType $fieldDefault $fieldFormat $fieldSize)
#if($fieldType == "date")
#if($fieldDefault != "")
= ${fieldDefault}#else
#if($fieldFormat != "") = FormatUtil.getToday("${fieldFormat}")#end
#end
#elseif($fieldType == "hex")
 = {#parseHex($fieldDefault)}#else
#if($fieldDefault != "")#if($fieldType == "String") = "${fieldDefault}"#else = ${fieldDefault}#end#end
#end
#end


## 설정파일에 지정된 프로퍼티의 타입으로 프로퍼티의 클래스내 타입을 지정합니다.
#macro(findFieldType $fieldType)
#if($fieldType == "date")String#elseif($fieldType == "length")
long#elseif($fieldType == "hex")
byte []#else
${fieldType}#end
#end

## 전문의 unmarshall 과정에 들어갈 타입별 변환을 설정합니다.
#macro(parseData $fieldType $fieldSize $fieldFormat $count)
#if($fieldType == "double")
		int [] splitSize${count} = StringUtil.splitFloatSize("${fieldFormat}", ",", StringUtil.CONTAIN_FLOAT_SIZE);
		buffer.setLength(0);
		buffer.append(new String(marshalledData, index, splitSize${count}[0]));
		buffer.append(".");
		index += splitSize${count}[0];
		buffer.append(new String(marshalledData, index, splitSize${count}[1]));
		this.field${velocityCount} = Double.parseDouble(buffer.toString());
		index += splitSize${count}[1];
#elseif($fieldType == "float")
		int [] splitSize${count} = StringUtil.splitFloatSize("${fieldFormat}", ",", StringUtil.CONTAIN_FLOAT_SIZE);
		buffer.setLength(0);
		buffer.append(new String(marshalledData, index, splitSize${count}[0]));
		buffer.append(".");
		index += splitSize${count}[0];
		buffer.append(new String(marshalledData, index, splitSize${count}[1]));
		this.field${velocityCount} = Float.parseFloat(buffer.toString());
		index += splitSize${count}[1];
#elseif($fieldType == "hex")
		System.arraycopy(marshalledData, index, this.field${velocityCount}, 0, ${fieldSize});
		index += ${fieldSize};
#elseif($fieldType == "byte")
		this.field${velocityCount} = marshalledData[index];
		index += ${fieldSize};
#elseif($fieldType == "short")
		this.field${velocityCount} = Short.parseShort(new String(marshalledData, index, ${fieldSize}));
		index += ${fieldSize};
#elseif($fieldType == "int")
		this.field${velocityCount} = Integer.parseInt(new String(marshalledData, index, ${fieldSize}));
		index += ${fieldSize};
#elseif($fieldType == "long" || $fieldType == "length")
		this.field${velocityCount} = Long.parseLong(new String(marshalledData, index, ${fieldSize}));
		index += ${fieldSize};
#elseif($fieldType == "char")
		this.field${velocityCount} = new String(marshalledData, index, ${fieldSize}).charAt(0);
		index += ${fieldSize};
#else
		this.field${velocityCount} = new String(marshalledData, index, ${fieldSize});
		index += ${fieldSize};
#end
#end

## 전문의 marshall 과정에 들어갈 타입별 변환을 설정합니다.
#macro(appendData $fieldType $fieldSize $fieldJustify $fieldFormat $class $fields $tailExist $tailSize $count)
## type == double || type == float
#if($fieldType == "double" || $fieldType == "float")
		String [] splitDouble${count} = StringUtil.splitDouble(this.field${count});
		int [] splitSize${count} = StringUtil.splitFloatSize("${fieldFormat}", ",", StringUtil.CONTAIN_FLOAT_SIZE);
		byte [] bfield${count}_i = FormatUtil.lPadding(splitDouble${count}[0], splitSize${count}[0], HeaderConstants.ZERO_CHAR).getBytes();
		System.arraycopy(bfield${count}_i, 0, marshalledData, index, bfield${count}_i.length);
		index += bfield${count}_i.length;
		byte [] bfield${count}_f = FormatUtil.rPadding(splitDouble${count}[1], splitSize${count}[1], HeaderConstants.ZERO_CHAR).getBytes();
		System.arraycopy(bfield${count}_f, 0, marshalledData, index, bfield${count}_f.length);
		index += bfield${count}_f.length;
## type == length
#elseif($fieldType == "length")
#if($fieldSize == "1")
		byte [] bfield${count} = Long.toString(#sizeParse($class $fieldFormat $fields $tailExist $tailSize)).getBytes();
		System.arraycopy(bfield${count}, 0, marshalledData, index, bfield${count}.length);
		index += ${fieldSize};
#else
		byte [] bfield${count} = FormatUtil.lPadding(Long.toString(#sizeParse($class $fieldFormat $fields $tailExist $tailSize)), $fieldSize, HeaderConstants.ZERO_CHAR).getBytes();
		System.arraycopy(bfield${count}, 0, marshalledData, index, bfield${count}.length);
		index += ${fieldSize};
#end
## type == hex
#elseif($fieldType == "hex")
		System.arraycopy(field${count}, 0, marshalledData, index, field${count}.length);
		index += ${fieldSize};		
## type == others...
#else
#if($fieldSize == "1")
#if($fieldType == "byte" || $fieldType == "short" || $fieldType == "int" || $fieldType == "long")
		byte [] bfield${count} = Long.toString(this.field${count}).getBytes();
#else
		byte [] bfield${count} = FormatUtil.#if($fieldJustify == "left")rPadding(this.field${count},#elseif($fieldJustify == "right")lPadding(this.field${count},#end ${fieldSize}, #distinguishType($fieldType)).getBytes();	    
#end
		System.arraycopy(bfield${count}, 0, marshalledData, index, bfield${count}.length);
		index += ${fieldSize};
#else
#if($fieldType == "byte" || $fieldType == "short" || $fieldType == "int" || $fieldType == "long")
		byte [] bfield${count} = FormatUtil.#if($fieldJustify == "left")rPadding(Long.toString(this.field${count}),#elseif($fieldJustify == "right")lPadding(Long.toString(this.field${count}),#end ${fieldSize}, #distinguishType($fieldType)).getBytes();	    
#else
		byte [] bfield${count} = FormatUtil.#if($fieldJustify == "left")rPadding(this.field${count},#elseif($fieldJustify == "right")lPadding(this.field${count},#end ${fieldSize}, #distinguishType($fieldType)).getBytes();	    
#end
		System.arraycopy(bfield${count}, 0, marshalledData, index, bfield${count}.length);
		index += ${fieldSize};
#end
#end
#end

## 주어진 문자열에서 ',' 앞에 있는 문자열을 가져옵니다.
#macro(sizeCP $fieldFormat)
#set($indexOfFC = ${fieldFormat.indexOf(",")})
#set($totalSize = ${fieldFormat.substring(0, ${indexOfFC})})
$totalSize#end

## 설정파일에 기술된 length 의 파싱형태를 지정합니다.
#macro(sizeParse $class $fieldFormat $fields $tailExist $tailSize)
#set($indexOfFC = ${fieldFormat.indexOf(",")})
#set($indexOfLC = ${fieldFormat.lastIndexOf(",")})
#set($indexOfFC1 = $indexOfFC + 1)
#set($indexOfLC1 = $indexOfLC + 1)
#set($startIndex = ${fieldFormat.substring(0, ${indexOfFC})})
#set($endIndex = ${fieldFormat.substring(${indexOfFC1}, ${indexOfLC})})
#set($strIndex = ${util.toInt($startIndex)})
#set($dataYn = ${fieldFormat.substring(${indexOfLC1})})
#set($fieldCount = 0)
#foreach($field in $fields)
#set($fieldCount = $fieldCount + 1)
#end
#if($endIndex == "*")
#calculateSize($fields $strIndex $fieldCount)#if($dataYn == "y") + this.data.length#if($tailExist == true) + $tailSize#end#end#else
#set($edIndex = ${util.toInt($endIndex)})
#calculateSize($fields $strIndex $edIndex)#if($dataYn == "y") + this.data.length#if($tailExist == true) + $tailSize#end#end#end
#end

## 전문의 지정된 부분부터 지정된 곳 까지의 길이를 계산합니다.
#macro(calculateSize $fields $startIndex $endIndex)
#set($fieldsSize = 0)
#foreach($field in $fields)
#set($fldSize = $field.getAttribute("size").getValue())
#if($velocityCount >= $startIndex && $velocityCount <= $endIndex)
#set($fieldsSize = $fieldsSize + ${util.toInt($fldSize)})
#end
#end
$fieldsSize#end

## hex 데이터 타입의 전문을 파싱합니다.
#macro(parseHex $fieldDefault)
#set($fieldDefault = $field.getAttribute("default").getValue())
#set($loopSize = ${fieldDefault.length()} / 2 - 1)
#set($loopCount = 0)
#foreach($loopCount in [0..$loopSize])
#set($strIndex = $loopCount * 2)
#set($endIndex = $strIndex + 2)
#set($fragStr = ${fieldDefault.substring($strIndex, $endIndex)})
(byte)0x${fragStr}#if($loopCount != $loopSize), #end
#set($loopCount = $loopCount + 1)
#end
#end